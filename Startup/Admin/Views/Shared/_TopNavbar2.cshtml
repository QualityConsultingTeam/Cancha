
 
<div class="row border-bottom white-bg">
    <nav class="navbar navbar-static-top navbar-fixed-top" role="navigation">
        <div class="navbar-header">
            <button aria-controls="navbar" aria-expanded="false" data-target="#navbar" data-toggle="collapse" class="navbar-toggle collapsed" type="button">
                <i class="fa fa-reorder"></i>
            </button>
            <a href="@Url.Action("Index","Canchas")" class="navbar-brand"><img src='@Url.Content("~/Images/logo_elc.png")'   /></a>
        </div>
        <div class="navbar-collapse collapse" id="navbar">
            <ul class="nav navbar-nav">
                @*<li class="active">
                        <a aria-expanded="false" role="button" href="@Url.Action("Index", "Layouts")"> Back to main Layout page</a>
                    </li>*@
                <li>
                    @using (Ajax.BeginForm("SearchFields", "Canchas", null, new AjaxOptions()
                    {
                        HttpMethod = "post",
                        InsertionMode = InsertionMode.Replace,
                        UpdateTargetId = "fieldsContainer",
                        LoadingElementId = "loaderSection",
                    }, new { @class = "navbar-form", role = "search", id = "searchFieldsForm" }))
                    {

                        @*<div class="input-group">
                            <button class="btn btn-info btn-circle btn-outline" type="button"
                                    data-toggle="button" data-placement="left" title="Tooltip on left">


                                <i class="fa fa-map-marker"></i>
                                
                            </button>
                        </div>*@
                        <input type="hidden" id="lat" name="lat" />
                        <input type="hidden" id="lon" name="lon" />

                        <div class="input-group">
                            @(Html.Kendo().DatePicker()
                                  .Name("date")
                                  .Value(DateTime.Now)
                                  .Format("dd/MM/yyyy")
                                  .HtmlAttributes(new { id = "date" })
                                  .Events(e=> e.Change("datechanged"))
                                  .Min(DateTime.Now)
                            )
                            @*</div>
                                <div class="input-group" style="width: 15px">*@
                            @(Html.Kendo().TimePicker()
                                  .Name("time")
                                  .Value(DateTime.Now)
                                  .Format("hh:00 tt").Min("7:00 AM").Max("11:00 PM").Interval(60)
                                  .Events(e=> e.Change("datechanged"))
                                  .HtmlAttributes(new { id = "time" })
                            )
                        </div>

                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="buscar" name="keywords" id="keywords">
                            <div class="input-group-btn">
                                <button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button>
                            </div>
                        </div>

                        @*<form class="navbar-form" role="search"></form>*@
                    }
                </li>

                @* <li  >
                        <div class="navbar-form">
                            @(Html.Kendo().TimePicker()
                              .Name("timepicker")
                              .Value("10:00 AM").HtmlAttributes(new{style="width:40%"})
                            )
                          </div>
                    </li>*@
                @*<li class="dropdown">
                        <a aria-expanded="false" role="button" href="#" class="dropdown-toggle" data-toggle="dropdown"> Menu item <span class="caret"></span></a>
                        <ul role="menu" class="dropdown-menu">
                            <li><a href="">Menu item</a></li>
                            <li><a href="">Menu item</a></li>
                            <li><a href="">Menu item</a></li>
                            <li><a href="">Menu item</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a aria-expanded="false" role="button" href="#" class="dropdown-toggle" data-toggle="dropdown"> Menu item <span class="caret"></span></a>
                        <ul role="menu" class="dropdown-menu">
                            <li><a href="">Menu item</a></li>
                            <li><a href="">Menu item</a></li>
                            <li><a href="">Menu item</a></li>
                            <li><a href="">Menu item</a></li>
                        </ul>
                    </li>*@

            </ul>
            <ul class="nav navbar-top-links navbar-right">
                @if (User.Identity.IsAuthenticated)
                {
                    @*<li>
                        <a href="@Url.Action("LogOut", "Account")">
                            <i class="fa fa-sign-out"></i> @User.Identity.Name - cerrar sesión
                        </a>
                    </li>*@
                    @Html.Partial("UserProfileNav")
                }
                else
                {
                    <li>
                        <a href="@Url.Action("Login", "Account")">
                            <i class="fa fa-sign-in"></i> Iniciar sesión
                        </a>
                    </li>
                }
            </ul>
        </div>
    </nav>
</div>

<script type="text/javascript">

    var Mylatitude;
    var Mylongitude;
    function showLocation(position) {
        console.log(position);
        Mylatitude = position.coords.latitude;
        Mylongitude = position.coords.longitude;
        console.log("Latitude : " + Mylatitude + " Longitude: " + Mylongitude);
        $("#lat").val(Mylatitude);
        $("#lon").val(Mylongitude);

        var d = new Date();
        var datevalue = d.getDate();
        console.log(datevalue);

        var hour = d.getHours();

        //$("#date").val(datevalue);
        //$("#time").val(hour);

        var filter = {
            keywords: '',
            lat: Mylatitude,
            lon: Mylongitude,
            date: d.getDate(),
            hour: d.getHours(),
    };
        // doSearch(filter);
        $("#searchFieldsForm").submit();
    }

   
   
    function errorHandler(err) {
        if (err.code == 1) {
            alert("Error: El acceso al GPS fue denegado,habilitalo para una mejor experiencia de usuario!");
        } else if (err.code == 2) {
            console.log("Error: el GPS no esta disponible!");
        }
        SerchWithoutLocation();
    }
    function getLocation() {

        if (navigator.geolocation) {
            // timeout at 60000 milliseconds (60 seconds)
            var options = { timeout: 60000 };
            navigator.geolocation.getCurrentPosition(showLocation,
                errorHandler,
                options);
        } else {
            console.log("Lo sentimos, tu navegador no soporta geolocalización!");
            SerchWithoutLocation();
        }
    }
    function RunSearch() {
        getLocation();
    }

    function SerchWithoutLocation() {
       
        $("#searchFieldsForm").submit();
        //
    }
    function datechanged() {
        $("#searchFieldsForm").submit();
    }
    //function activeCarousel() {
    //    console.log("set Carousel");
    //    $(".owl-carousel").owlCarousel();
    //}
</script>