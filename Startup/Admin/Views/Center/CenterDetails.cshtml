@model Access.Models.Center

@{
    ViewBag.Title = "Complejo Deportivo";
    Layout = null;
    Func<Access.Models.ImageField, string> IsActiveItem = (item) =>
    {
        return Model.ImageField.FirstOrDefault() == item ? "Active" : "";
    };

    var first = Model.ImageField.FirstOrDefault();

    var index = 1;
}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Add Your favicon here -->
    <!--<link rel="icon" href="img/favicon.ico">-->

    <title>En La Cancha</title>

    @Styles.Render("~/bundles/landingcss")
    <!-- Bootstrap core CSS -->
    @*<link href="https://djrm1arjukiyk.cloudfront.net/css/bootstrap.min.css" rel="stylesheet">*@

    <!-- Animation CSS -->
    @*<link href="https://djrm1arjukiyk.cloudfront.net/css/animate.min.css" rel="stylesheet">*@

    @*<link href="https://djrm1arjukiyk.cloudfront.net/font-awesome/css/font-awesome.min.css" rel="stylesheet">*@

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Custom styles for this template -->
    @*<link href="https://djrm1arjukiyk.cloudfront.net/css/style.css" rel="stylesheet">*@
</head>

<body id="inicio">
    <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC4mbXflTyT-qgUjKpXrl2OQ7RE0BuMsaU">
    </script>

    <!--INICIO TOOLBAR-->
    <div class="navbar-wrapper">
        <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header page-scroll">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    @*<a class="navbar-brand" href="#">WEBAPPLAYERS</a>*@
                    @Html.ActionLink("Buscar Canchas", "Index", "Canchas", null, new { @class = "navbar-brand" })
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a class="page-scroll" href="#inicio">Inicio</a></li>
                        <li><a class="page-scroll" href="#info">Información</a></li>
                        <li><a class="page-scroll" href="#servicios">Servicios</a></li>
                        <li><a class="page-scroll" href="#mapa">Mapa</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
    <!--INICIO TOOLBAR-->
    <!--INICIO CAROUSEL-->
    <div id="inSlider" class="carousel carousel-fade" data-ride="carousel">
        <ol class="carousel-indicators">
            <li data-target="#inSlider" data-slide-to="0" class="active"></li>
            @foreach (var item in Model.ImageField.Where(i => i != first))
            {
                <li data-target="#inSlider" data-slide-to="@index"></li>
                {
                    index++;
                }
                @*<li data-target="#inSlider" data-slide-to="2"></li>*@
            }
        </ol>
        <div class="carousel-inner" role="listbox">
            <div class="item active">
                <div class="container">
                    <div class="carousel-caption">
                        <h1>@first.header1</h1>
                        <p>@first.header2</p>
                    </div>
                    <div class="carousel-image wow zoomIn">
                        <img src="~/Images/logo_elc.png" alt="laptop" style="max-height:310px;max-width:310px" />
                    </div>
                </div>
                <!-- Set background for slide in css -->

                <div class="header-back" style="background: url('@first.imgUrl') 50% 0 no-repeat;">

                </div>

            </div>

            @foreach (var item in Model.ImageField.Where(i => i != first))
            {

                <div class="item">
                    <div class="container">
                        <div class="carousel-caption blank">
                            <h1>@item.header1</h1>
                            <p>@item.header2</p>
                            <p><a class="btn btn-lg btn-primary" href="@item.header2" role="button">Ir a mi sitio</a></p>
                        </div>
                        <div class="carousel-image  zoomIn">
                            <img src="~/Images/logo_elc.png" alt="laptop" style="max-height:310px;max-width:310px" />
                        </div>
                    </div>
                    <!-- Set background for slide in css -->
                    <div class="header-back " style="background: url('@item.imgUrl') 50% 0 no-repeat;">

                    </div>
                </div>

            }

        </div>
        <a class="left carousel-control" href="#inSlider" role="button" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="right carousel-control" href="#inSlider" role="button" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
    <!--FIN CAROUSEL-->
    <!--INICIO INFORMACION-->
    <section id="info" class="container services">
        <div class="row m-b-lg">
            <div class="col-lg-12 text-center">
                <div class="navy-line"></div>
                <h1>Información</h1>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <h2>Descripción</h2>
                <p>@Model.Description</p>
            </div>

            <div class="col-sm-3">
                <h2>Contactos</h2>
                <p>
                    <ul class="fa-ul">
                        <li><i class="fa fa-phone"></i>&nbsp  @Model.Phone1</li>
                        <li><i class="fa fa-phone"></i>&nbsp  @Model.Phone2</li>
                        <li><i class="fa fa-envelope"></i>&nbsp @Model.Email</li>
                    </ul>
                </p>
            </div>

            <div class="col-sm-3">
                <h2>Horarios</h2>
                <p>
                    <ul class="fa-ul">
                        <li><i class="fa fa-calendar-o"></i>&nbsp @TimeSpan.FromHours(Model.Opentime).ToString("hh':'mm")  </li>
                        <li>&nbsp &nbsp &nbsp a</li>
                        <li><i class="fa fa-calendar-o"></i>&nbsp @TimeSpan.FromHours(@Model.Closetime).ToString("hh':'mm") </li>
                    </ul>
                </p>

            </div>

            <div class="col-sm-3">
                <h2>Canchas</h2>
                <p>
                    <ul class="fa-ul">
                        @foreach (var item in Model.Fields)
                        {
                            <li><i class="fa fa-futbol-o"></i>&nbsp  @item.Name </li>
                        }
                    </ul>
                </p>
            </div>
        </div>
    </section>
    <!--CIERRE INFORMACION-->
    <!--INICIO SERVICIOS-->
    <section id="servicios" class="gray-section team">
        <div class="container">
            <div class="row m-b-lg">
                <div class="col-lg-12 text-center">
                    <div class="navy-line"></div>
                    <h1>Servicios</h1>
                    <p>Contamos con los siguientes servicios</p>
                </div>
            </div>
            <div class="row">
                @foreach (var item in Model.Services)
                {
                    <div class="col-sm-4">
                        <div class="team-member">
                            <i class="@item.IconName fa-5x"></i>
                            <h4><span class="navy">@item.Name</span></h4>
                            <p>@item.Description</p>
                        </div>
                    </div>
                }
            </div>

            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 text-center m-t-lg m-b-lg">
                    <p>mensaje sobre servicios</p>
                </div>
            </div>
        </div>
    </section>
    <!--CIERRE SERVICIOS-->
    <!--INICIO MAPA-->
    <section id="mapa" class="navy-section google-map">
        <div class="row m-b-lg">
            <div class="col-lg-12 alignleft">
                <a href="http:\\waze.to\?ll=@Model.Coordinates.Latitude,@Model.Coordinates.Longitude&navigate=yes">
                    <img src="~/Images/waze.png" style="max-height:64px;max-width:64px" />
                </a>
            </div>
        </div>
        <div class="google-map" id="fieldmap" style="height: 500px"></div>
    </section>
    <!--CIERRE MAPA-->

    @Scripts.Render("~/bundles/landingscripts")

    <script type="text/javascript">

        var Mylatitude;
        var Mylongitude;

        //Variables mapa
        var map;
        var mapCenter;
        var fieldMarker;
        var directionsDisplay = new google.maps.DirectionsRenderer();
        var directionsService = new google.maps.DirectionsService();;

        $(function () {
            getLocation();

        });

        function getLocation() {

            if (navigator.geolocation) {
                // timeout at 60000 milliseconds (60 seconds)
                var options = { timeout: 60000 };
                navigator.geolocation.getCurrentPosition(showLocation,
                    errorHandler,
                    options);
            } else {
                console.log("Lo sentimos, tu navegador no soporta geolocalización!");
                SerchWithoutLocation();
            }
        }

        function showLocation(position) {
            console.log(position);
            Mylatitude = position.coords.latitude;
            Mylongitude = position.coords.longitude;
            console.log("Latitude : " + Mylatitude + " Longitude: " + Mylongitude);
            //$("#lat").val(Mylatitude);
            //$("#lon").val(Mylongitude);

            // $("#searchFieldsForm").submit();
            initialize();
        }

        function errorHandler(err) {
            if (err.code == 1) {
                alert("Error: El acceso al GPS fue denegado,habilitalo para una mejor experiencia de usuario!");
            } else if (err.code == 2) {
                console.log("Error: el GPS no esta disponible!");
            }
            SerchWithoutLocation();
        }

        function SerchWithoutLocation() {

            $("#searchFieldsForm").submit();
            //
        }

        function initialize() {

            var lat = '@Model.Coordinates.Latitude';
            var lon = '@Model.Coordinates.Longitude';
            console.log("field Coordinates lat=" + lat + " lon: " + lon);
            mapCenter = new google.maps.LatLng(lat, lon);
            var mapOptions = {
                center: mapCenter,
                zoom: 15
            };
            map = new google.maps.Map(document.getElementById("fieldmap"),
                mapOptions);

            directionsDisplay.setMap(map);

            displayPotision();
        }

        function displayPotision() {
            fieldMarker = new google.maps.Marker({
                position: mapCenter,
                title: '@Model.Name',
            });


            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(Mylatitude, Mylongitude),
                title: "mi ubicacion",
            });
            marker.setMap(map);
            fieldMarker.setMap(map);
            console.log(marker);

            var request = {
                origin: new google.maps.LatLng(Mylatitude, Mylongitude),
                destination: mapCenter,
                travelMode: google.maps.TravelMode.DRIVING
            };
            directionsService.route(request, function (response, status) {
                if (status == google.maps.DirectionsStatus.OK) {
                    directionsDisplay.setDirections(response);
                }
            });
        }
    </script>

</body>

</html>
